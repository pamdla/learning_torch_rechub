# 多任务学习 (Multi-Task Learning)

## 概述

多任务学习（Multi-Task Learning，MTL）通过共享表示同时学习多个相关任务，提升模型泛化能力。在推荐系统中常用于同时优化CTR、CVR等多个目标。

---

## 模型对比总表

| 模型 | 原理 | 优点 | 缺点 | 复杂度 | 负迁移 | 参数量 | 选型建议 |
|:----:|------|------|------|:------:|:------:|:------:|----------|
| **SharedBottom** | 共享底层+独立塔 | 结构简单、推理快、易部署 | 任务冲突时负迁移严重 | ⭐ | ❌ | 小 | 资源有限/任务强相关首选 |
| **ESMM** | 全空间CTR/CVR级联 | 解决样本选择偏差 | 仅适用级联任务 | ⭐ | ❌ | 小 | CTR+CVR联合优化首选 |
| **MMoE** | 多专家+门控动态组合 | 灵活解耦，自动平衡共享/独立 | 门控增加复杂度 | ⭐⭐ | ✅ | 中 | 通用多任务/任务有冲突 |
| **PLE** | 分层专家(专享+共享)渐进提取 | 有效缓解负迁移，表达能力强 | 参数量大、训练慢 | ⭐⭐⭐ | ✅✅ | 大 | 大规模工业/严重负迁移 |
| **AITM** | 注意力自适应传递任务信息 | 建模任务依赖，可解释性好 | 需设计注意力，训练较难 | ⭐⭐ | ✅ | 中 | 用户行为序列/任务依赖 |

---

## 快速选型

```
判断维度 → 推荐模型

任务强相关 ──────→ SharedBottom
CTR+CVR级联 ────→ ESMM
任务有冲突 ──────→ MMoE ─→ 冲突严重 → PLE
序列依赖 ────────→ AITM
```

| 判断维度 | 条件 | 推荐模型 |
|----------|------|----------|
| **任务关系** | 强相关 | SharedBottom |
| | 级联(CTR→CVR) | ESMM |
| | 有冲突 | MMoE / PLE |
| | 序列依赖 | AITM |
| **资源** | 有限 | SharedBottom / ESMM |
| | 充足 | MMoE / PLE / AITM |
| **数据量** | 小 | SharedBottom |
| | 大 | PLE / AITM |


## 心得总结

刚深挖 MMoE 模型，觉得它用多专家网络 + 门控动态路由太聪明了！共享专家学通用模式，任务专家挖特异需求，完美解决 B 端“是否进货”和“进多少”的梯度冲突。torch-rechub 上手快，但 Embedding 索引越界和标签格式坑不少，数据校验和特征工程还是得用心～

---
## 运行示例

### 依赖安装
```bash
pip install torch_rechub numpy pandas torch joblib
```

### 运行
```bash
python demo.py
```

### 输出
- 训练完成后显示 Task 1/2 AUC
- 生成 `mmoe.onnx` ONNX模型
- 生成 `predictions.csv` 预测结果
- 当前AUC: Task1≈0.72, Task2≈0.80

### 关键参数调优
| 参数 | 当前值 | 说明 |
|------|--------|------|
| n_samples | 10000 | 样本数量 |
| n_expert | 16 | 专家数量 |
| expert_dims | [256, 128] | 专家网络维度 |
| tower_dims | [128, 64] | 任务塔维度 |
| lr | 0.001 | 学习率 |
| n_epoch | 200 | 训练轮数 |
| batch_size | 128 | 批量大小 |


### 运行日志

```bash
root@2c4349dd5b67:/workspace# python demo.py 
the samples of train : val : test are  7000 : 1000 : 2000
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.33it/s]
train loss:  {'task_0:': np.float64(0.5912955565886064), 'task_1:': np.float64(0.5857753298499367)}
loss weight:  [0.042959727346897125, 0.03433791175484657]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 68.91it/s]
epoch: 0 validation scores:  [0.7327895580363122, 0.5018578027716409]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.51it/s]
train loss:  {'task_0:': np.float64(0.5768455922603607), 'task_1:': np.float64(0.5248820055614818)}
loss weight:  [0.07458464056253433, 0.0378962904214859]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.26it/s]
epoch: 1 validation scores:  [0.7349972980587591, 0.5230746914820023]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.66it/s]
train loss:  {'task_0:': np.float64(0.5766136982224205), 'task_1:': np.float64(0.5227622238072482)}
loss weight:  [0.0995936170220375, 0.04231126233935356]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 81.58it/s]
epoch: 2 validation scores:  [0.7329650687493938, 0.505528776416505]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.12it/s]
train loss:  {'task_0:': np.float64(0.5750354306264357), 'task_1:': np.float64(0.5214708615433086)}
loss weight:  [0.11615584045648575, 0.04220730438828468]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 85.76it/s]
epoch: 3 validation scores:  [0.7356069668515687, 0.5232643770502778]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.54it/s]
train loss:  {'task_0:': np.float64(0.5731966040351174), 'task_1:': np.float64(0.5191229847344485)}
loss weight:  [0.12259376049041748, 0.04073120653629303]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 41.56it/s]
epoch: 4 validation scores:  [0.7354406935444389, 0.5080393207025061]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.25it/s]
train loss:  {'task_0:': np.float64(0.5715779364109039), 'task_1:': np.float64(0.520786525444551)}
loss weight:  [0.1277933567762375, 0.04157936945557594]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 84.54it/s]
epoch: 5 validation scores:  [0.735218995801599, 0.5234094307201357]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.26it/s]
train loss:  {'task_0:': np.float64(0.5729208886623383), 'task_1:': np.float64(0.5204507524316961)}
loss weight:  [0.13163961470127106, 0.03773745521903038]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 84.33it/s]
epoch: 6 validation scores:  [0.7362351104562818, 0.509501015375689]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.66it/s]
train loss:  {'task_0:': np.float64(0.5737351471727544), 'task_1:': np.float64(0.5173208084973422)}
loss weight:  [0.13589248061180115, 0.036733563989400864]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 77.04it/s]
epoch: 7 validation scores:  [0.7363736715455566, 0.47906206065475]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.11it/s]
train loss:  {'task_0:': np.float64(0.5735915736718611), 'task_1:': np.float64(0.519069271737879)}
loss weight:  [0.13503220677375793, 0.035090263932943344]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 88.96it/s]
epoch: 8 validation scores:  [0.7369741029324144, 0.5097576487915914]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.95it/s]
train loss:  {'task_0:': np.float64(0.5730777615850622), 'task_1:': np.float64(0.5186050198294899)}
loss weight:  [0.1360221654176712, 0.03643379360437393]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 65.28it/s]
epoch: 9 validation scores:  [0.7364290959812665, 0.4829506148044007]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.64it/s]
train loss:  {'task_0:': np.float64(0.5720457678491419), 'task_1:': np.float64(0.5173827084628019)}
loss weight:  [0.13537508249282837, 0.03546066954731941]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 81.61it/s]
epoch: 10 validation scores:  [0.7363505780306774, 0.5662281582647117]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.46it/s]
train loss:  {'task_0:': np.float64(0.5741394584829157), 'task_1:': np.float64(0.5156329073689201)}
loss weight:  [0.1358603537082672, 0.03436996042728424]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 73.90it/s]
epoch: 11 validation scores:  [0.7368586353580189, 0.5446932672781237]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.45it/s]
train loss:  {'task_0:': np.float64(0.5711935617706992), 'task_1:': np.float64(0.5129485959356481)}
loss weight:  [0.13560284674167633, 0.031697921454906464]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 72.38it/s]
epoch: 12 validation scores:  [0.7394728212423387, 0.5824630113141862]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.44it/s]
train loss:  {'task_0:': np.float64(0.5683225929737091), 'task_1:': np.float64(0.5102599127726122)}
loss weight:  [0.13363441824913025, 0.030304310843348503]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 74.24it/s]
epoch: 13 validation scores:  [0.7397499434208886, 0.5784461404565844]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.10it/s]
train loss:  {'task_0:': np.float64(0.5662587984041734), 'task_1:': np.float64(0.5043926190246235)}
loss weight:  [0.12730783224105835, 0.018348541110754013]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 65.86it/s]
epoch: 14 validation scores:  [0.7419853956611904, 0.5419260895762201]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.40it/s]
train loss:  {'task_0:': np.float64(0.5678187885067679), 'task_1:': np.float64(0.5037835430015217)}
loss weight:  [0.1284927874803543, 0.01661180891096592]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 37.98it/s]
epoch: 15 validation scores:  [0.7084997990864205, 0.5648780433375734]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.07it/s]
train loss:  {'task_0:': np.float64(0.5648204467513345), 'task_1:': np.float64(0.5000257362018932)}
loss weight:  [0.12709392607212067, 0.008617737330496311]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 41.01it/s]
epoch: 16 validation scores:  [0.7461653218543168, 0.5651625716899867]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.66it/s]
train loss:  {'task_0:': np.float64(0.5604007303714752), 'task_1:': np.float64(0.4908700769597834)}
loss weight:  [0.11890488117933273, -0.002730698324739933]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 40.20it/s]
epoch: 17 validation scores:  [0.7397730369357678, 0.6384146749681998]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.22it/s]
train loss:  {'task_0:': np.float64(0.562169474363327), 'task_1:': np.float64(0.4926907062530518)}
loss weight:  [0.12020238488912582, -0.0029525940772145987]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 39.98it/s]
epoch: 18 validation scores:  [0.7474447025786218, 0.7082357010555446]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.93it/s]
train loss:  {'task_0:': np.float64(0.5579884111881256), 'task_1:': np.float64(0.4796948373317719)}
loss weight:  [0.11560768634080887, -0.0029531207401305437]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.82it/s]
epoch: 19 validation scores:  [0.7457912069132746, 0.6950302381111779]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.44it/s]
train loss:  {'task_0:': np.float64(0.5554775888269597), 'task_1:': np.float64(0.474917471408844)}
loss weight:  [0.10935764014720917, -0.0029529351741075516]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 54.24it/s]
epoch: 20 validation scores:  [0.7555551450041801, 0.7091618129477137]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:04<00:00, 12.39it/s]
train loss:  {'task_0:': np.float64(0.5608388163826682), 'task_1:': np.float64(0.45467319651083515)}
loss weight:  [0.1114279106259346, -0.002952743088826537]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.01it/s]
epoch: 21 validation scores:  [0.6452235683175451, 0.6866059672848185]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:04<00:00, 12.01it/s]
train loss:  {'task_0:': np.float64(0.5594058361920443), 'task_1:': np.float64(0.45393758578733967)}
loss weight:  [0.11101134866476059, -0.002952538663521409]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.28it/s]
epoch: 22 validation scores:  [0.7537723256555094, 0.743946798777086]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:04<00:00, 12.23it/s]
train loss:  {'task_0:': np.float64(0.5613072801720013), 'task_1:': np.float64(0.40295552015304564)}
loss weight:  [0.10993597656488419, -0.002952329581603408]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 31.92it/s]
epoch: 23 validation scores:  [0.7519294631681531, 0.8626676485684318]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:04<00:00, 12.74it/s]
train loss:  {'task_0:': np.float64(0.5602061672644182), 'task_1:': np.float64(0.36016750660809604)}
loss weight:  [0.11415930837392807, -0.0029521118849515915]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 67.96it/s]
epoch: 24 validation scores:  [0.7514075497318844, 0.8177400638236147]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.58it/s]
train loss:  {'task_0:': np.float64(0.5600391577590595), 'task_1:': np.float64(0.3482713374224576)}
loss weight:  [0.11437630653381348, -0.0029518846422433853]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 40.76it/s]
epoch: 25 validation scores:  [0.7491905723034857, 0.8963256789627547]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.10it/s]
train loss:  {'task_0:': np.float64(0.559906725991856), 'task_1:': np.float64(0.35788314830173146)}
loss weight:  [0.11357156187295914, -0.002951651578769088]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.42it/s]
epoch: 26 validation scores:  [0.7547422532804338, 0.6989383187163867]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.68it/s]
train loss:  {'task_0:': np.float64(0.5556490990248594), 'task_1:': np.float64(0.3529388051141392)}
loss weight:  [0.10986395925283432, -0.0029514082707464695]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.61it/s]
epoch: 27 validation scores:  [0.7546914475476996, 0.8966659971881903]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.88it/s]
train loss:  {'task_0:': np.float64(0.5583705116402019), 'task_1:': np.float64(0.33539811995896424)}
loss weight:  [0.11247993260622025, -0.0029511558823287487]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 41.68it/s]
epoch: 28 validation scores:  [0.7556475190636966, 0.8969728414898127]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.73it/s]
train loss:  {'task_0:': np.float64(0.5570128213275563), 'task_1:': np.float64(0.33275707987221803)}
loss weight:  [0.10821616649627686, -0.0029508965089917183]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.29it/s]
epoch: 29 validation scores:  [0.7555135766773975, 0.8932628149338334]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.20it/s]
train loss:  {'task_0:': np.float64(0.5562584671107206), 'task_1:': np.float64(0.3331126229329543)}
loss weight:  [0.10692616552114487, -0.002950627589598298]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.47it/s]
epoch: 30 validation scores:  [0.7524929449312043, 0.8558166521612997]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.00it/s]
train loss:  {'task_0:': np.float64(0.5523207951675762), 'task_1:': np.float64(0.3456592061302879)}
loss weight:  [0.10552503168582916, -0.0029503479599952698]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 30.54it/s]
epoch: 31 validation scores:  [0.7417175108885923, 0.6983274196067929]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.98it/s]
train loss:  {'task_0:': np.float64(0.5535442650318145), 'task_1:': np.float64(0.3412194961851293)}
loss weight:  [0.10121092200279236, -0.0029500601813197136]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 39.85it/s]
epoch: 32 validation scores:  [0.7342536868796503, 0.7117393050813416]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.34it/s]
train loss:  {'task_0:': np.float64(0.5537378099831668), 'task_1:': np.float64(0.33189842321655966)}
loss weight:  [0.10273470729589462, -0.002949763787910342]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 40.02it/s]
epoch: 33 validation scores:  [0.7475694075589693, 0.7674566512686617]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.84it/s]
train loss:  {'task_0:': np.float64(0.5566893713040786), 'task_1:': np.float64(0.34087611816146157)}
loss weight:  [0.10561572760343552, -0.002949456451460719]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 39.90it/s]
epoch: 34 validation scores:  [0.7593979058800707, 0.7808294838320948]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.13it/s]
train loss:  {'task_0:': np.float64(0.5583463842218572), 'task_1:': np.float64(0.3309383893554861)}
loss weight:  [0.106698177754879, -0.0029491381719708443]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.49it/s]
epoch: 35 validation scores:  [0.7452600560710543, 0.819185021534891]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.96it/s]
train loss:  {'task_0:': np.float64(0.5580408654429696), 'task_1:': np.float64(0.32673304758288646)}
loss weight:  [0.1072750985622406, -0.0029488103464245796]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.77it/s]
epoch: 36 validation scores:  [0.7544558936959324, 0.8848831760058914]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.80it/s]
train loss:  {'task_0:': np.float64(0.555700911175121), 'task_1:': np.float64(0.32254636612805454)}
loss weight:  [0.11022920161485672, -0.002948472509160638]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 41.53it/s]
epoch: 37 validation scores:  [0.7524698514163253, 0.8973075807279463]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.22it/s]
train loss:  {'task_0:': np.float64(0.5508670828559182), 'task_1:': np.float64(0.31740615259517324)}
loss weight:  [0.10401216149330139, -0.0029481244273483753]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 40.99it/s]
epoch: 38 validation scores:  [0.75027134879983, 0.8992546472964228]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.15it/s]
train loss:  {'task_0:': np.float64(0.5527251091870394), 'task_1:': np.float64(0.31005424532023346)}
loss weight:  [0.09819002449512482, -0.002947765402495861]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 30.33it/s]
epoch: 39 validation scores:  [0.7472368609447095, 0.8986409586931781]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.90it/s]
train loss:  {'task_0:': np.float64(0.5534979955716567), 'task_1:': np.float64(0.3124745471910997)}
loss weight:  [0.09754807502031326, -0.002947394037619233]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 41.58it/s]
epoch: 40 validation scores:  [0.7542711455768991, 0.856050969627993]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.29it/s]
train loss:  {'task_0:': np.float64(0.5591008982875131), 'task_1:': np.float64(0.3078985902396115)}
loss weight:  [0.10656856745481491, -0.0029470110312104225]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 38.36it/s]
epoch: 41 validation scores:  [0.7528162541395125, 0.8723137176139788]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 14.76it/s]
train loss:  {'task_0:': np.float64(0.5541500194506211), 'task_1:': np.float64(0.3058624438264153)}
loss weight:  [0.10573874413967133, -0.002946616383269429]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 39.05it/s]
epoch: 42 validation scores:  [0.7497124857397546, 0.8718060297694762]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 15.83it/s]
train loss:  {'task_0:': np.float64(0.5567144133827903), 'task_1:': np.float64(0.2970020532608032)}
loss weight:  [0.10610061883926392, -0.0029462098609656096]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 41.33it/s]
epoch: 43 validation scores:  [0.758414122146219, 0.8836725357613087]
train: 100%|███████████████████████████████████████████████████████████████████| 55/55 [00:03<00:00, 16.00it/s]
train loss:  {'task_0:': np.float64(0.5521071981300008), 'task_1:': np.float64(0.28616941950537944)}
loss weight:  [0.10283824056386948, -0.0029457909986376762]
validation: 100%|████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 39.77it/s]
epoch: 44 validation scores:  [0.569167386414547, 0.7021155519850037]
validation best auc of main task 0: 0.759398
validation: 100%|██████████████████████████████████████████████████████████████| 16/16 [00:00<00:00, 45.04it/s]
Task 1 AUC: 0.7153978702422329
Task 2 AUC: 0.7964784263959391
Predictions shape: (2000, 2)
Predictions saved to predictions.csv
```
